<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>テスト分析ツールwebR</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

</head>
<body>
    <header>
        <h1>テスト分析ツールwebR</h1>
    </header>
    <div class="container">
        <section class="upload-section">
            <h2>ファイルのアップロード</h2>
            <p>分析対象のExcelファイルを選択してください。ファイルは外部に送信されません。</p>
            <p><a href="../index.html" target="_blank" rel="noopener noreferrer">テスト分析前処理ツール</a>で出力された、<strong>3_Exametrika_binary.xlsx</strong>は、そのままアップロードできます。</p>
            <div class="file-input-wrapper">
                <input type="file" id="upload" accept=".xlsx" ;">

            </div>
            <button id="process-button" class="btn btn-primary">処理開始</button>
            <button id="templatedownloadBtn_exmk" class="btn btn-secondary">テンプレートファイルのダウンロードはこちら (.xlsx)</button>
        </section>

        <section class="data-section">
            <h2>処理されたデータ</h2>
            
            <div id="data-info" class="info"></div>
            <div class="table-container">
                <table id="data-table">
                    <tbody>
                        <!-- データ行はここに挿入されます -->
                    </tbody>
                </table>
            </div>
        </section>

        <section class="code-section">
            <h2>分析コードの実行</h2>
            <p>webRを使って、ブラウザ上でRを実行します。編集も可能です。<a href="./man.html" target="_blank" rel="noopener noreferrer">簡易マニュアル</a></p>
            <p>testdataという変数に、アップロードしたテストの正誤データが保存されています。</p>
            <div class="button-group">
                <button class="sample-code-button btn btn-outline" data-code="sample1">クロンバックのα係数</button>
                <button class="sample-code-button btn btn-outline" data-code="sample2">YenのQ3統計量</button>
                <button class="sample-code-button btn btn-outline" data-code="sample3">スクリープロット(カテゴリカル)</button>
                <button class="sample-code-button btn btn-outline" data-code="sample4">空欄</button>
            </div>
            <textarea id="r-code" class="code-editor" placeholder="ここにコードを記入"></textarea>
            <button id="run-button" class="btn btn-primary">コードを実行</button>
        </section>

        <section class="result-section">
            <h2>実行結果</h2>
            <button id="save-button" class="btn btn-secondary">実行結果をテキストファイルとして保存</button>
            
            <div class="output-container">
                <pre id="out">ここに結果が表示されます(初回実行時はライブラリのロードのため時間がかかります。)</pre>
            </div>
            <div id="plot-container"></div>
        </section>
    </div>
    
    <script type="module" src="script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
</body>
</html>